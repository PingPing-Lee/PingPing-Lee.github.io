(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{432:function(t,e,a){"use strict";a.r(e);var v=a(14),r=Object(v.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("React Native 快速刷新（Fast Refresh）是默认开启的，你不用做任何额外的配置，就能立刻体验到。")]),t._v(" "),e("p",[t._v("快速刷新提效的本质是及时反馈，所码即所见。")]),t._v(" "),e("p",[t._v("那原理是什么呢？")]),t._v(" "),e("h2",{attrs:{id:"模块热替换"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#模块热替换"}},[t._v("#")]),t._v(" 模块热替换")]),t._v(" "),e("p",[t._v("React Native 的快速刷新功能的最早期版本，叫做热重载 Hot Reload，是基于 Webpack 的模块热替换（Hot Module Replacement）的原理开发的。")]),t._v(" "),e("p",[t._v("在项目启动时会执行 react-native start 命令，启动一个 Metro 服务，而 Metro 服务就实现了模块热替换的功能。")]),t._v(" "),e("p",[t._v("Metro 服务会把更新的代码打包发送给 React Native 应用，让应用能够及时更新，大致流程如下：")]),t._v(" "),e("ol",[e("li",[t._v("Metro 服务会监听代码文件的变化，当你修改完代码保存文件时，Metro 服务就会收到通知。保存好后，Metro 就会编译，编译完成后再生成一个用于更新的 bundle。")]),t._v(" "),e("li",[t._v("当新 bundle 生成时，模块热替换服务会通过项目在启动时与模块热替换客户端（HMR Client）建立的 socket 通知块热替换客户端，热替换客户端实际就是运行在 React Native 应用中的一段 JavaScript 代码，它一开始就执行了一个 socket 监听事件。")]),t._v(" "),e("li",[t._v("React Native 收到通知后，就会向请求 bundle 服务发起请求。然后，bundle 服务会返回一个用于更新的 bundle。")]),t._v(" "),e("li",[t._v("这个 bundle 是由多个模块组成的，你修改代码文件对应的模块及其依赖模块都是新模块，新模块会把原先的旧模块替换掉。")])]),t._v(" "),e("p",[t._v("这就是整个模块热替换的全部过程，具体可以参考下图：\n"),e("img",{attrs:{src:"/img/rn/debug/mkrth.png",alt:"mkrth"}})])])}),[],!1,null,null,null);e.default=r.exports}}]);